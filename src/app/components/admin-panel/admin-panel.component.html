<div class="home-button">
  <a routerLink="/" class="list-group-item list-group-item-action">
    <div class="d-flex justify-content-center">
      <p class="m-0">&lsaquo;</p>
      <svg width="1.6em" height="1.3em" viewBox="0 0 16 16" class="bi bi-house-door-fill" fill="currentColor"
        xmlns="http://www.w3.org/2000/svg">
        <path
          d="M6.5 10.995V14.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5V11c0-.25-.25-.5-.5-.5H7c-.25 0-.5.25-.5.495z" />
        <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
      </svg>
      <p class="m-0">Retour à l'accueil</p>
    </div>
  </a>
</div>

<!-- FORM CREATION TIMBRE -->
<div class="formTimbre">
  <div class="card-header">
    <h4 class="mb-0">Ajouter un timbre</h4>
    <div class=" card card-outline-secondary">
      <form [formGroup]="timbreForm" class="px-4 py-3 justify-content-between row" (ngSubmit)="addTimbre()">
        <!-- CATEGORIE DU TIMBRE -->
        <div class="btn-group col-12" role="group" aria-label="Basic example">
          <button type="button" (click)="timbreForm.controls['categorie'].setValue('classic')"
            [ngClass]="{'active': timbreForm.value.categorie == 'classic'}" class="btn btn-secondary">Classique</button>
          <button type="button" (click)="timbreForm.controls['categorie'].setValue('spe')"
            [ngClass]="{'active': timbreForm.value.categorie == 'spe'}" class="btn btn-secondary">Spécial</button>
          <button type="button" (click)="timbreForm.controls['categorie'].setValue('tas')"
            [ngClass]="{'active': timbreForm.value.categorie == 'tas'}" class="btn btn-secondary">Taxe Av Serv</button>
          <button type="button" (click)="timbreForm.controls['categorie'].setValue('cd')"
            [ngClass]="{'active': timbreForm.value.categorie == 'cd'}" class="btn btn-secondary">Coin
            Daté</button>
          <button type="button" (click)="timbreForm.controls['categorie'].setValue('obl')"
            [ngClass]="{'active': timbreForm.value.categorie == 'obl'}" class="btn btn-secondary">Oblitéré</button>
        </div>

        <div *ngIf="timbreForm.value.categorie =='tas'" class="btn-group btn-group-sm col-6 mt-1 mx-auto" role="group"
          aria-label="Basic example">
          <button type="button" (click)="timbreForm.controls['tasType'].setValue('PA')"
            [ngClass]="{'active': timbreForm.value.tasType == 'PA'}" value="PA" class="btn btn-secondary">PA</button>
          <button type="button" (click)="timbreForm.controls['tasType'].setValue('Serv')"
            [ngClass]="{'active': timbreForm.value.tasType == 'Serv'}" value="Serv"
            class="btn btn-secondary">Serv</button>
          <button type="button" (click)="timbreForm.controls['tasType'].setValue('Taxe')"
            [ngClass]="{'active': timbreForm.value.tasType == 'Taxe'}" value="PA"
            class="btn btn-secondary">Taxe</button>
          <button type="button" (click)="timbreForm.controls['tasType'].setValue('PR')"
            [ngClass]="{'active': timbreForm.value.tasType == 'PR'}" value="PR" class="btn btn-secondary">PR</button>
        </div>

        <div class="form-content row mx-auto col-12 p-0 my-2 justify-content-md-center"
          *ngIf="timbreForm.value.categorie">
          <!-- ETAT DU TIMBRE -->
          <div class="col-4">
            <select id="typeInput" class="custom-select" formControlName="etat">
              <option value="neuf">Neuf</option>
              <option value="occas">Charnière</option>
              <option value="sg">Sans Gomme</option>
            </select>
          </div>

          <!-- NUMERO DU TIMBRE -->
          <div class="col-4">
            <input type="text" class="form-control" id="numeroInput" placeholder="Numéro" aria-label="Numéro du timbre"
              formControlName="numero">
          </div>
          <!-- ANNEE POUR CD -->
          <div *ngIf="timbreForm.value. categorie == 'cd'" class="col-4">
            <input id="anneeCoinDateInput" type="number" min="0" max="2999" placeholder="Année coin daté"
              aria-label="Année coin daté" class="form-control" formControlName="anneeCoinDate">
          </div>
          <!-- INFOS SUPP POUR OBL/SPE/TAS -->
          <div
            *ngIf="timbreForm.value.categorie == 'classic' || timbreForm.value.categorie == 'obl' || timbreForm.value.categorie == 'spe'|| timbreForm.value.categorie == 'tas'"
            class="col-4">
            <input id="optionalInfosInput" type="text" placeholder="Infos supp. (a,b..)" aria-label="infos supp."
              class="form-control" formControlName="optionalInfos">
          </div>
          <!-- PRIX TIMBRE -->
          <div class="col-4">
            <input placeholder="Prix" type="text" step="0.01" min="0" id="prixInput" class="form-control"
              aria-label="Prix" formControlName="prix">
          </div>
          <!-- QTE TIMBRE -->
          <div class="col-4">
            <input type="number" min="0" placeholder="Quantité" aria-label="quantité" id="quantiteInput"
              class="form-control" formControlName="quantite">
          </div>
          <div class="col-8">
            <input type="url" class="form-control" id="imageInput" aria-label="url de l'image"
              placeholder="URL de l'image" formControlName="image">
          </div>
          <button type="submit" id="sendBtn" class=" btn btn-primary">Ajouter</button>

        </div>

      </form>
    </div>
  </div>

  <!-- LOADING GIF -->
  <div *ngIf="loading" id="loading">
    <img src="../../../assets/img/loading.gif">
  </div>
  <!-- TABLE TIMBRES -->
  <table *ngIf="timbreList.length>0" class="table table-bordered table-striped">
    <thead class="thead-dark">
      <tr>
        <th>Catégorie</th>
        <th>N°</th>
        <th>Prix</th>
        <th>Image</th>
        <th>Quantité</th>
        <th>État</th>
        <th>Suppr.</th>
      </tr>
    </thead>
    <tbody *ngIf="!loading">
      <tr *ngFor="let timbre of timbreList; index as i">
        <td>
          <p class="mb-0" *ngIf="timbre.catTimbre=='classic'">Classique</p>
          <p class="mb-0" *ngIf="timbre.catTimbre == 'spe'">Spécial</p>
          <p class="mb-0" *ngIf="timbre.catTimbre == 'tas'">Taxe Av Serv</p>
          <p class="mb-0" *ngIf="timbre.catTimbre == 'cd'">Coin Daté</p>
          <p class="mb-0" *ngIf="timbre.catTimbre == 'obl'">Oblitéré</p>
        </td>

        <td>
          <div class="d-flex">
            <p class="text-center mb-0 font-weight-bold">{{timbre.numeroTimbre}}</p>
            <p class="text-center mb-0 font-weight-bold">{{timbre.optionalInfos}}</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='occas'">*</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='sg'">SG</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='cd'">({{timbre.anneeCoinDate}})</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre == 'obl'">{{timbre.optionalInfos}}</p>
          </div>
        </td>
        <td>{{ timbre.prixTimbre }}€</td>
        <td>
          <a [href]="timbre.imageTimbreUrl" target="_blank">
            <img [src]="timbre.imageTimbreUrl" class="">
          </a>
        </td>
        <td (blur)="updateTimbre(timbre)">
          <div class="d-flex">
            <button (click)="changeTimbreQte(timbre,'minus')" class="qteBtn" [disabled]=" timbre.quantiteTimbre==0">
              <p>-</p>
            </button>
            <p>{{ timbre.quantiteTimbre }}</p>
            <button (click)="changeTimbreQte(timbre,'plus')" class="qteBtn">
              <p>+</p>
            </button>

          </div>
        </td>
        <td>
          <div>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='neuf'">Neuf</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='occas'">Occasion</p>
            <p class="mb-0" *ngIf="timbre.etatTimbre=='sg'">Sans Gomme</p>
          </div>
        </td>
        <td>
          <button type="button" (click)="deleteTimbreById(timbre)" class="btn btn-outline-danger"><svg width="1em"
              height="1em" viewBox="0 0 16 16" class="bi bi-trash-fill" fill="currentColor"
              xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z" />
            </svg></button>
        </td>
      </tr>
    </tbody>
  </table>
